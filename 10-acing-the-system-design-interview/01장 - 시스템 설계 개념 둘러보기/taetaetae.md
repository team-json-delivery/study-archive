## 01. 시스템 설계 개념 둘러보기
#### 1.1 트레이드 오프 논의
- 시스템 설계 면접은 정답을 찾는 과정이 아니라, 다양한 접근법과 각 접근법의 트레이드오프(trade-off)를 논의하는 자리다.
- 설계 과정에서 리소스, 시간, 요구사항을 기반으로 가장 적합한 절충안을 선택해야 한다.
- 시스템 설계 능력과 커뮤니케이션 능력은 개발자에게 매우 중요하며, 특히 높은 직급으로 올라갈수록 더 중요해진다.

#### 1.2. 이 책을 어떻게 읽어야 할까?
- 시스템 설계 면접은 질문이 개방형식이라서 명확한 준비가 어렵다.
- 이 책은 흩어져 있는 다양한 자료들을 체계적으로 정리하여 효과적인 면접 준비를 돕는다.
- 책을 통해 시스템 설계 개념을 이해하고, 면접 상황에서 핵심 내용을 간결하게 전달하는 법을 연습할 수 있다.
- 의사소통 능력이 중요하다. 기술을 짧은 시간에 간결하고 명확히 전달하는 연습. 좋은 질문을 할수 있는 능력. 

#### 1.3. 이 책의 개요
- 1부: 시스템 설계 면접에서 자주 다뤄지는 주제를 교과서처럼 설명한다.
- 2부: 실제 면접 질문 예시와 각 사례의 논의 및 안티패턴, 실수 등을 다룬다.
- 시스템 설계는 명확한 정답이 없으므로, 면접에서는 다양한 접근법의 장단점을 논의하는 능력이 필요하다.

#### 1.4. 시스템의 다양한 서비스 확장 방식
- 1.4.1. 시작 : 앱의 소규모 초기 배포
  - 베이글 카페에 대한 게시물을 읽고 쓰는 소비자 대상 앱
  - 클라이언트 3개 : 브라우저, iOS, 안드로이드
  - 서버 : 프론트엔드, 백엔드, SQL

- 1.4.2. GeoDNS를 통한 확장
  - DAU가 늘어남에 따라 서버에러(504)가 발생
  - 상태 비저장이므로 동일한 백엔드 호스트를 프로비저닝 하여 세계 각지의 다른 데이터 센터에 배치
  - GeoDNS를 사용하여 사용자 위치에 따라 가장 가까운 서버로 요청을 라우팅

- 1.4.3. 캐싱 서비스 추가
  - 레디스 캐시를 활용하여 사용자 기반과 요청 부하가 계속 증가하는 동안 대응 가능

- 1.4.4 콘텐츠 배포 네트워크(CDN)
  - 앱의 소스코드 스토리지 내에 두었던 정적 콘텐츠/파일을 CDN으로 옮겨서 전 세계 사용자에게 빠르게 제공
  - CDN은 정적 콘텐츠를 전 세계에 분산된 서버에 캐싱하여 사용자에게 가장 가까운 서버에서 콘텐츠를 제공함으로써 로드 시간을 단축시킨다.

- 1.4.5 수평적 확장성과 클러스터 관리, 지속적 통합, 지속적 배포에 관한 간단한 논의
  - 프론트와 백엔드 서비스는 멱등성을 가지므로 수평적 확장이 가능
  - 지속적 통합과 지속적 배포를 위한 CI/CD 파이프라인 구축
  - IaC(Infrastructure as Code)를 통해 인프라를 코드로 관리하여 배포 자동화(앤서블, 테라폼)
  - 점진적 롤아웃과 롤백 : 비율적으로 배포, 문제 발생시 자동으로 롤백
  - 실험(A/B 테스트)을 통해 새로운 기능을 점진적으로 배포하고, 사용자 피드백을 반영하여 개선

- 1.4.6. 기능적 분할과 교차 관심사의 중앙 집중화
  - 서비스가 성장하면, 전체 시스템을 기능별로 나누어 관리하는 것이 효율적이다. 이를 기능별 분할이라 한다.
  - 기능별 분할을 통해 서비스가 커졌을 때 각 서비스별 요구사항과 확장성을 독립적으로 관리할 수 있다.
  - 서비스가 많아지면 공통으로 사용되는 기능들을 별도의 공유 서비스로 만들어 관리하는 것이 효율적이다.
  - 공유서비스
    - 검색
    - 로깅 및 모니터링
    - API Gateway
  - API 게이트웨이의 단점과 보완책
    - API 게이트웨이는 서비스 호출 과정에 추가적인 지연을 발생시킬 수 있고, 각 데이터센터에 배치되는 방식에 따라 복잡해질 수 있다.
    - 서비스 메쉬는 서비스와 함께 사이드카 프록시를 배치하여 동일 호스트 내에서 요청과 응답을 처리함으로써 네트워크 지연을 최소화한다.
  - 사이드카 없는 서비스 메쉬
    - 기존 서비스 메쉬는 컨테이너 수를 거의 두 배로 증가시키므로 복잡성을 유발
    - 클라이언트 서비스가 프록시 로직을 내장하는 방식
  - CQRS
    - 데이터의 읽기와 쓰기를 별도의 서비스로 나누어 관리하는 패턴
    - 읽기와 쓰기를 분리하여 데이터 처리 효율성, 확장성, 유지보수성을 높일 수 있다.
    - 이 방식은 시스템의 복잡도를 증가시키지만, 서비스별로 독립적인 확장이 가능하여 큰 규모의 시스템에 유리

- 1.4.7. 배치 및 스트리밍 추출, 변환, 적재(ETL)
  - 비동기적으로 처리 가능한 작업들은 배치(Batch) 처리나 스트리밍(Streaming) 방식의 ETL을 이용하면 효과적이다.
  - ETL(Extract, Transform, Load)
    - 대규모 데이터 쿼리를 처리하는 경우 실시간 처리가 아닌 주기적(batch) 처리가 효과적이다.
    - 데이터가 몇 시간 또는 며칠 정도 오래된 상태로 표시되어도 무방한 경우에 주로 사용된다.
    - 로그 수집 시스템처럼 대량의 요청이 들어오는 경우에는 동기식 처리를 하면 매우 큰 클러스터를 운영해야 하므로 비효율적이다.
  - 사용 가능한 ETL 도구
    - 배치(Batch) ETL: Airflow
    - 스트리밍 ETL: Apache Kafka, Apache Flink

- 1.4.8. 기타 필요 서비스
  - 시스템 규모가 커지면서 다양한 기능과 서비스가 추가로 필요해짐
  - 사용자 인증 및 권한 관리 서비스
  - 다양한 데이터 저장소
  - 내부 데이터 분석 및 머신러닝 플랫폼
  - 내부 검색 및 자동 완성 서비스
  - 개인정보 보호와 프라이버시 준수 서비스
  - 사기 탐지 시스템

- 1.4.9. 클라우드 vs 베어 메탈
  - 클라우드의 장점: 초기 투자 비용 없음, 빠른 설치 및 확장, 자동 확장 지원, 관리 용이성, 좋은 문서와 지원 서비스
  - 클라우드의 단점: 특정 클라우드 서비스에 대한 의존성, 데이터 프라이버시 문제
  - 베어메탈의 장점: 데이터 통제력 강화, 특정 상황에서 비용 효율성 증가 
  - 베어메탈의 단점: 초기 투자비용 높음, 관리와 유지보수의 복잡성 증가, 하드웨어 및 소프트웨어의 업그레이드 어려움
  - 일반적으로 기업 규모가 일정 수준 이상일 경우 클라우드보다 베어메탈이 더 유리할 수도 있음

- 1.4.10. 서버리스: 서비스로서의 함수(FaaS)
  - 서버리스는 AWS Lambda, Azure Functions 등과 같이 함수 단위로 실행 환경을 제공한다.
  - 장점
    - 적은 사용 빈도의 함수 실행 시 비용 절감 효과 크다.
    - 서버 관리 부담 없이 함수의 비즈니스 로직 구현에만 집중할 수 있다.
  - 단점
    - 콜드 스타트(Cold start) 문제, 벤더 종속성 문제
    - 자바 등 초기화가 느린 프레임워크는 적합하지 않을 수 있으며, GraalVM 등의 빠른 시작 프레임워크를 사용할 수 있다.
  - Spring Cloud Function과 같은 추상화된 프레임워크는 여러 클라우드 플랫폼 간 이식성을 높인다.

- 1.4.11. 결론: 백엔드 서비스 확장
  - 백엔드 서비스의 확장은 사용자의 요청에 따라 동적으로 처리해야 하므로 프론트엔드 서비스보다 확장성이 더 복잡하다.
  - 시스템 확장 방법으로 GeoDNS, 캐싱, CDN, 수평 확장, CI/CD, 기능 분할, ETL, 클라우드 및 베어메탈의 선택, 서버리스 컴퓨팅 등이 있다.
  - 시스템 설계 시 다양한 확장성 기법을 이해하고, 적절히 적용할 수 있는 능력이 중요하다.