## 02. 일반적인 시스템 설계 면접 흐름
#### 2.1. 요구사항 명확화와 트레이드오프 논의
- 시스템 설계 면접의 첫 번째 단계는 요구사항(기능적, 비기능적 요구사항)을 구체적으로 명확히 하는 과정임
- 요구사항 정의는 전체 면접의 약 10분 정도를 할애하여 진행하는 것이 적절함
- 요구사항 명확화 과정에서 다음과 같은 사항을 반드시 논의해야 함:
  - 시스템의 전반적 목적과 비즈니스 맥락을 명확하게 이해해야 함
  - 사용자 유형(개인 vs 기업, 수동 사용자 vs API 호출 등)을 고려해야 함
  - 사용자 역할(판매자, 구매자, 관리자 등)을 정의하고, 각 역할별 권한과 작업 내용을 논의해야 함
  - 시스템의 사용 규모(일간 활성 사용자(DAU), 초당 처리 요청 수(QPS), 허용 가능한 최대 지연시간(latency))를 구체적인 숫자로 정의해야 함
  - 데이터 접근 방식 및 접근 빈도를 명확히 논의해야 함(실시간, 정기적 배치 등)
  - 검색 기능 지원 여부 및 범위를 명확히 할 필요가 있음
  - 분석 및 머신러닝 기능을 필요로 하는지, A/B 테스트 등의 실험 지원 여부도 논의 필요
- 면접자는 항상 추가적인 요구사항이 있는지 능동적으로 질문하고 확인하는 자세가 필요함
- 이 과정에서 시스템의 모든 사항이 트레이드오프를 가지고 있다는 점을 인지하고 면접관과 충분히 논의해야 함

#### 2.2. API 명세 초안 작성
- 요구사항이 명확해진 후, 다음 단계는 시스템의 API를 구체적으로 작성(draft)하는 단계임
- API 명세는 일반적으로 다음과 같은 방식으로 구성함
  - RESTful API의 GET, POST, PUT, DELETE 엔드포인트를 빠르게 나열함
  - 주요 API의 엔드포인트 경로(path), 파라미터(parameter), 요청(request)과 응답(response)의 구조를 간략히 나타냄
- API 초안 작성에는 너무 많은 시간을 소비하지 않고(약 5분 이내), 주요 기능과 핵심 작업에 초점을 맞추어 빠르게 작성할 필요가 있음
- 공통적으로 필요한 API 예시 (빠르게 언급하고 지나가면 됨)
  - 서비스 상태 점검(health check): GET /health
  - 사용자 인증(회원 가입, 로그인): POST /signup, POST /login
  - 사용자 프로필 및 컨텐츠 관리 API 등

#### 2.3. 사용자와 데이터 간의 연결과 처리
- 이 단계에서는 사용자, 시스템, 데이터 간의 처리 흐름과 구조를 명확히 그림으로 표현하는 단계. 다음의 4가지 단계로 구체화
  - 1: 사용자와 시스템 연결 정의
    - 사용자 유형별 박스와 시스템 컴포넌트를 명확하게 그리고 연결 관계를 표현함
    - 사용자와 시스템이 어떻게 상호작용하는지 시각적으로 표현하는 것이 핵심임
  - 2: 요청 처리 및 데이터 저장 분리
    - 시스템이 사용자 요청을 처리하는 방식과 데이터가 저장되는 방식을 명확히 구분하여 나타냄
    - 처리 방식을 실시간 vs 비동기 방식으로 구분하여 명확히 정의해야 함
    - 공통으로 사용하는 서비스가 있다면 별도 구성요소로 표현함
  - 3: 시스템 세부 컴포넌트 정의 및 연결
    - 각 시스템을 더욱 세부적인 컴포넌트나 서비스로 나누고, 이를 서로 연결하여 구조화함
    - 이 과정에서 로깅, 모니터링, 알림, 보안같은 공통 관심사도 반드시 포함하여 정의함
  - 4: 시스템 요약과 장애 내성 정의
    - 최종적으로 시스템 설계를 요약하며, 놓친 부분이나 추가할 사항을 면접관과 함께 확인함
    - 각 컴포넌트에서 발생할 수 있는 장애 상황을 명확히 정의하고, 이를 방지하거나 복구할 방법을 논의하는 것이 중요함
    - 네트워크 장애, 데이터 일관성, 병목등 시스템에서 흔히 발생할 수 있는 장애 상황을 구체적으로 언급함

#### 2.4. 데이터 모델 설계
- 시스템 설계 면접에서는 데이터 모델 설계도 중요한 평가 요소 중 하나임
- API 요청과 응답을 기반으로 데이터 모델 설계를 시작하며, 데이터 모델은 요청 및 응답 구조와 직접적으로 연결되어야 함
- 서로 다른 서비스가 동일한 데이터베이스를 공유하는 방식은 안티패턴으로 간주됨. 다음 이유 때문
  - 서로 다른 서비스 간 데이터 쿼리 충돌 가능성 존재
  - 데이터베이스 스키마 변경 시 여러 서비스에 영향을 줄 가능성이 큼
  - 특정 기술에 종속되어 시스템의 유연성을 떨어뜨릴 가능성 있음
- 여러 서비스가 데이터베이스를 공유할 때 발생할 수 있는 문제 예시
  - 전자상거래 시스템에서 주문과 메트릭 서비스가 동일 데이터베이스를 공유할 경우, 스키마 변경과 같은 작업이 매우 복잡해질 수 있음
  - 따라서, 서비스가 커질수록 데이터베이스의 독립적 사용을 권장하며, 필요 시 API 및 ETL 작업을 통해 데이터 접근 방식을 조정해야 함
- 동시 사용자 업데이트 충돌 방지 기법 예시
  - 여러 사용자가 동시에 같은 데이터를 수정할 때 발생하는 문제를 방지하는 방법
  - 데이터 잠금 및 타임스탬프 기반 방법을 활용하여 데이터를 보호할 수 있음
  - 예를 들어, 호텔 예약 시스템에서 여러 사용자가 동일한 객실을 동시에 예약하는 상황을 방지하기 위한 잠금 메커니즘
    - 편집중이다라는 필드로 잠금처리
    - UI 와 협력 필요

#### 2.5. 로깅, 모니터링, 경보
- 모니터링의 중요성
  - 모니터링은 고객 경험을 실시간으로 드러내어 버그·성능 저하·예상 외 이벤트를 즉각 파악 가능함
  - 장애는 긴급도 단계로 구분해 긴급 알람에 우선 대응 필요
  - 우리 서비스가 다른 서비스의 의존성일 때, 상세 로그·모니터링은 책임 경계 조사에 필수적임
- 관찰 가능성
  - 관찰 가능성은 시스템 내부 상태를 로그·메트릭·트레이싱으로 유추 가능한 정도를 의미
  - 지연·트래픽·오류·포화도를 핵심 지표로 설정해 대시보드·알람 구축 필요
  - 메트릭·대시보드·알람 도구를 통합해 서비스 상태를 지속 추적 필요
  - OS 레벨 CPU·메모리·디스크·네트워크 I/O 수치는 자원 배분 튜닝과 메모리 누수 탐지에 유용함
- 경보 대응
  - 팀은 긴급 알람을 위해 온콜 일정을 운영 필요
  - 런북에 알람·원인·조치 절차를 정리해 초보 온콜러도 신속 대응 가능함
  - 반복 명령은 애플리케이션 자동화로 전환해 휴먼 오류 감소 필요
  - SRE 팀 커버리지 확보 시 테스트 커버리지·런북 완성도 기준 충족 필요
  - 장애 종료 후 재발 방지 계획 수립 필요
- 애플리케이션 수준 로깅 툴
  - 오픈소스 ELK(Elasticsearch·Logstash·Beats·Kibana)와 상용 Splunk가 대표적 로그 플랫폼
  - Prometheus+Grafana·Sensu·Nagios·Zabbix 등 FOSS 모니터링 대안 존재함
  - TSDB(OpenTSDB·InfluxDB 등)는 로그 시계열 집계·다운샘플링으로 저장소 절감 가능함
  - 툴 선정 시 기능·자원 소모·학습 곡선·통합 용이성 등 특성을 비교 필요
- 데이터 품질에 대한 스트리밍·배치 감사
  - 데이터 품질은 실세계 반영 정확성과 목적 적합성을 의미함
  - 최근 삽입·변경 데이터를 스트리밍·배치 ETL로 검증해 품질 저하 조기 탐지 필요
  - 목적은 요청 처리 시 놓친 무감지 오류를 후속 감사로 발견 가능함
- 데이터 이상 탐지
  - 연속 데이터를 모델링해 비정상 패턴 확률 판별 가능함
  - 모델 훈련·검증·테스트 세트로 정확도·정밀도 튜닝 필요
  - 구현·운영 비용이 높아 중요 데이터셋에만 적용 권장함
- 무감지 오류와 감사
  - 상태 코드 200 반환 중에도 발생할 숨은 오류를 배치 감사로 탐지 필요
  - 감사 실패 시 알람을 즉시 발송해 조치 가능 체계 구축 필요

#### 2.6. 검색창
- 소개
  - 탐색 UI 구성 요소(단일 검색창·필터 드롭다운)의 존재 필요성 → 사용자 경험 개선 필요
  - 구현 방식 3단계(① SQL LIKE 패턴 매칭 ② 클라이언트 라이브러리 match-sorter ③ 검색엔진 Elasticsearch) → 확장성 관점 선택 중요
  - LIKE 검색의 제약(맞춤 점수·전처리 부재) 및 엔진 전환 필요성 → 기술 부채 방지 중요함
- 일래스틱서치를 활용한 검색창 구현
  - GET 엔드포인트로 검색어 전달 → Elasticsearch index 조회 필요
  - DSL 활용
  - 결과 JSON hits 리스트 정렬 → 프런트엔드 결과 페이지 렌더링 필요
- 일래스틱서치 인덱스와 수집
  - 문서 수집→Bulk API 색인→주기적 재색인 플로우 정의 필요
  - 매핑 변경 시 새 index 생성 또는 reindex 선택 → 비용·성능 트레이드오프 고려 중요
- SQL 대신 일래스틱서치 사용하기
  - Query context vs Filter context 개념 → 검색·질의 혼합 가능 장점 존재
  - 관계형 제약(정규화·FK) 부재, ACID 미지원 → 완전 대체 시 리스크 고려 필요
  - EQL JSON 문법 학습 곡선 → 비개발자 접근성 낮음 주의 필요

#### 2.7. 기타 논의 가능한 주제
- 애플리케이션 유지보수·확장
- 다른 유형의 사용자 지원
- 대안적 아키텍처 결정
- 사용성과 피드백
- 에지 케이스와 새로운 제약 조건
  - 확장성과 성능
  - 지연시간과 처리량
  - 가용성과 내결함성
  - 비용
- 클라우드 네이티브 개념으로 비기능적 요구사항을 해결하는 방법 논의

#### 2.8. 면접 후 회고와 평가
- 면접 직후 회고록 작성
  - 상황, 질문내용, 느낀점 등
- 평가 작성 : self
- 피드백 요청

#### 2.9. 회사 면접하기
- 기술블로그 읽어보거나
- 회사의 기술스택 등 전반적으로 관심 갖기